#### 注意事项

* 啥误差公式……平时误差不都是让你们算的，多项式误差公式不会给的
* Newton-Cotes积分公式的积分误差要记嘛。。
  可以算的……你会算积分公式误差就能算了……
  书上分成奇数和偶数讨论，并且说不加证明地给出以下结果。。
* 考试会给一些公式吗？比如样条函数那个  -》  不会，这种公式和计算都很繁杂的，经常会考性质，例如三次样条的连续性，自由度等等
* 讲过的都在范围内

#### 问题

* ==书p121 例6.3 为啥保留4位小数时误差要满足那个要求？==
* ==书p133 例 6.8？ 中心差商的外推公式==
* 书p135-136之间的笔记：待定系数法和精度没看懂； 
* 7.1.2节 向后、中心差商Euler公式的局部截断误差精度阶数？
* 7.1.2节：整体截断误差？

作业：

# 计算方法笔记

### 绪论

#### 0.2 误差与有效数字

* 绝对误差与绝对误差界![image-20210227161719236](D:\科大\大三上\计算方法\image\image-20210227161719236.png)

* 相对误差与相对误差限

  ![image-20210227161907390](D:\科大\大三上\计算方法\image\image-20210227161907390.png)

* 产生误差的主要原因
  * 原始误差（建模时产生的）
  * 截断误差：有限项近似无限项
  * 舍入误差：如四舍五入产生的误差
* 有效位数
  
* ![image-20210227162349424](D:\科大\大三上\计算方法\image\image-20210227162349424.png)
  
* 要避免相近的数相减（相对误差大）；也要避免除以一个绝对值很小的数

  可考虑换成其他等价形式或者用近似公式

* 控制误差：选择收敛的稳定的方法、提高数值计算精度

#### 0.3 矩阵和向量范数

##### 向量范数

* 向量范数需要满足的三个性质![image-20210227160549752](D:\科大\大三上\计算方法\image\image-20210227160549752.png)

* **向量的$L_p$范数**![image-20210227160734628](D:\科大\大三上\计算方法\image\image-20210227160734628.png)

* 不同向量范数之间是等价的（定理0.1,范数等价原理）

  ![image-20210227162606337](D:\科大\大三上\计算方法\image\image-20210227162606337.png)

* 向量序列的极限与收敛

  ![image-20210227162736320](D:\科大\大三上\计算方法\image\image-20210227162736320.png)

  ![image-20210227162855772](D:\科大\大三上\计算方法\image\image-20210227162855772.png)

##### 矩阵范数

* 矩阵范数的性质：**以下的讨论里矩阵是方阵**

  ![image-20210227163118590](D:\科大\大三上\计算方法\image\image-20210227163118590.png)

* 根据向量范数定义矩阵范数（向量均为列向量）![image-20210227163329029](D:\科大\大三上\计算方法\image\image-20210227163329029.png)

  ![image-20210227163339498](D:\科大\大三上\计算方法\image\image-20210227163339498.png)

  ![image-20210227163352244](D:\科大\大三上\计算方法\image\image-20210227163352244.png)

* 常用的矩阵范数

  ![image-20210227163533781](D:\科大\大三上\计算方法\image\image-20210227163533781.png)

* 从属范数的性质

  ![image-20210227164133013](D:\科大\大三上\计算方法\image\image-20210227164133013.png)

* F范数![image-20210227164521246](D:\科大\大三上\计算方法\image\image-20210227164521246.png)

* 不同定义的矩阵范数之间也是等价的

* 矩阵特征值求法： A为n阶矩阵，若数λ和n维非0列向量x满足$Ax=λx$，那么数λ称为A的特征值，x称为A的对应于特征值λ的特征向量。式Ax=λx也可写成( A-λE)x=0，并且$|λE-A|$叫做A 的特征多项式。当**特征多项式等于0的时候，称为A的特征方程**，特征方程是一个齐次线性方程组，求解特征值的过程其实就是求解特征方程的解。https://blog.csdn.net/Junerror/article/details/80222540

##### 谱半径与收敛矩阵

* ![image-20210227170219813](D:\科大\大三上\计算方法\image\image-20210227170219813.png)

* 谱半径：![image-20210227170247506](D:\科大\大三上\计算方法\image\image-20210227170247506.png)

* 矩阵的收敛与极限

  ![image-20210227170444303](D:\科大\大三上\计算方法\image\image-20210227170444303.png)

  ![image-20210227170617972](D:\科大\大三上\计算方法\image\image-20210227170617972.png)

##### 矩阵的条件数

* 用于分析解方程组时元素误差对方程组解的影响

* 定义：![image-20210227170854368](D:\科大\大三上\计算方法\image\image-20210227170854368.png)

  元素误差的两种扰动情况（推导的话，主要利用矩阵范数的2-5条性质来放缩）

  1. ![image-20210227171350080](D:\科大\大三上\计算方法\image\image-20210227171350080.png)

  2. ![image-20210227171431118](D:\科大\大三上\计算方法\image\image-20210227171431118.png)

     ![image-20210227171442437](D:\科大\大三上\计算方法\image\image-20210227171442437.png)

  上述两种情况均可知，若矩阵A的条件数越大，那么不等式右边越大，即模型带来的误差越大

### 第一章 插值

#### 绪论

* ![image-20210227173413434](D:\科大\大三上\计算方法\image\image-20210227173413434.png)
* 函数逼近的方法：插值、拟合
* ![image-20210227173612458](D:\科大\大三上\计算方法\image\image-20210227173612458.png)
* 构造插值函数需关注的问题
  * 插值函数是否存在
  * 插值函数是否唯一
  * 如何表示插值函数
  * 如何估计被插函数与插值函数的误差
  * 主要研究多项式函数类
  * 如何构造插值函数

#### 1.1 Lagrange插值多项式

##### 1.1.1 线性插值

* 即通过两个点作插值：两点式、点斜式、截距式、待定系数法
* ![image-20210227174156191](D:\科大\大三上\计算方法\image\image-20210227174156191.png)

##### 1.1.2 二次插值

* 三个点的插值，用插值基函数方法构造$L_2(x)$， 每个基函数是一个二次函数，可以设出来
* ![image-20210227175333966](D:\科大\大三上\计算方法\image\image-20210227175333966.png)

##### 1.1.3 n次拉格朗日插值多项式

* 给定 n+1 个不同插值点 -> 找到一条不高于n次的插值多项式

* n+1个不同点可以唯一决定一个次数至多为n的多项式 =》 证明：待定系数法（n+1个系数），系数行列式为范德蒙行列式 -》 行列式!=0，有唯一解

* ![image-20210227193637440](D:\科大\大三上\计算方法\image\image-20210227193637440.png)

  ![image-20210227193758180](D:\科大\大三上\计算方法\image\image-20210227193758180.png)

* 性质：![image-20210227193858876](D:\科大\大三上\计算方法\image\image-20210227193858876.png)

##### n次插值多项式的误差

* ![image-20210227195038078](D:\科大\大三上\计算方法\image\image-20210227195038078.png)

  后续的具体证明是对$\Psi(t)$的n+2个零点，由Rolle定理，得到其n+1阶导数有一个零点，再对$\Psi(t)$求n+1阶导，可得k(x)

* $R_n(x)$是截断误差

* ![image-20210227195800541](D:\科大\大三上\计算方法\image\image-20210227195800541.png)

* 当常常不知道f(x)的表达式时：求误差的**事后估计方法**![image-20210228181014697](D:\科大\大三上\计算方法\image\image-20210228181014697.png)

#### 1.2 Newton插值多项式

![image-20210227200234065](D:\科大\大三上\计算方法\image\image-20210227200234065.png)

计算的动机及推导：为何引入差商、Newton插值的基函数是什么：见ipad书p25后的笔记

##### 1.2.1 差商及其计算

* 一阶、二阶差商![image-20210227200633072](D:\科大\大三上\计算方法\image\image-20210227200633072.png)

* 0、k阶差商![image-20210227200653542](D:\科大\大三上\计算方法\image\image-20210227200653542.png)

* 差商的性质：

  1. 归纳法可证![image-20210227201017757](D:\科大\大三上\计算方法\image\image-20210227201017757.png)
  2. ![image-20210227201122104](D:\科大\大三上\计算方法\image\image-20210227201122104.png)

* 差商的计算: 建立差商表

  ![image-20210227201750270](D:\科大\大三上\计算方法\image\image-20210227201750270.png)

##### 1.2.2 Newton插值

* 线性插值：两个插值点，利用点斜式构造，![image-20210227202214494](D:\科大\大三上\计算方法\image\image-20210227202214494.png)

* 二次插值: 三个插值点，![image-20210227202401451](D:\科大\大三上\计算方法\image\image-20210227202401451.png)

  与线性插值对比，关注增加的部分：承袭性

* n次Newton插值函数

  * ![image-20210227203524576](D:\科大\大三上\计算方法\image\image-20210227203524576.png)

    再接着展开$f[x,x_0]$![image-20210227203608822](D:\科大\大三上\计算方法\image\image-20210227203608822.png)

    ![image-20210227203045477](D:\科大\大三上\计算方法\image\image-20210227203045477.png)

  * 得到![image-20210227203117724](D:\科大\大三上\计算方法\image\image-20210227203117724.png)

* Newton插值多项式和拉格朗日插值多项式完全等价，只是选取的基不同，同样余项也相同![image-20210227203856186](D:\科大\大三上\计算方法\image\image-20210227203856186.png)

* Newton插值多项式的基函数，以及其承袭性的表现

  ![image-20210227204218298](D:\科大\大三上\计算方法\image\image-20210227204218298.png)

##### 例题

* 例1.6（p30）很特别
* 例1.7： $N_n(x)$的嵌套乘法形式![image-20210227204702539](D:\科大\大三上\计算方法\image\image-20210227204702539.png)

#### 1.3 Hermite插值

* ![image-20210227205734522](D:\科大\大三上\计算方法\image\image-20210227205734522.png)

* ![image-20210227210043515](D:\科大\大三上\计算方法\image\image-20210227210043515.png)

  条件：f(x)有一阶连续导数，给定 xi,f(xi),f'(xi)共2n+2个条件

  结果：确定一个至多为2n+1次的多项式函数$H_{2n+1}(x)$

* 给定四个条件，可确定一个3次多项式  -》 待定系数法得到方程组，分析行列式可知有解且唯一

##### 1.3.1 **Lagrange型**：

* 通过插值基函数做出$H_{2n+1}(x)$

  $h_i(x),g_i(x)$，均为不超过2n+1次的多项式

  如![image-20210227210642228](D:\科大\大三上\计算方法\image\image-20210227210642228.png)

  ![image-20210227211211170](D:\科大\大三上\计算方法\image\image-20210227211211170.png)

  ![image-20210227211346256](D:\科大\大三上\计算方法\image\image-20210227211346256.png)

  以上的推导过程，见书p34后加的一页笔记

* 误差为![image-20210227211509475](D:\科大\大三上\计算方法\image\image-20210227211509475.png)

* 例1.9： 自己用待定系数法，仿照上述构造推导表达式

##### 1.3.2 Newton型

* 广义差商(表)

  ![image-20210227214133670](D:\科大\大三上\计算方法\image\image-20210227214133670.png)

* ![image-20210227214601287](D:\科大\大三上\计算方法\image\image-20210227214601287.png)
* 运算技巧![image-20210227215018161](D:\科大\大三上\计算方法\image\image-20210227215018161.png)
* 变式：不给满条件，比如只给f(x0),f'(x0),f(xi)  （详见ipad书补充页56）

#### 1.4 三次样条函数

##### 1.4.1 分段插值

* 龙格现象：插值多项式在插值区间内发生剧烈振荡的现象。

  说明高次插值多项式效果未必比低次好，等距插值不能保证有好的插值效果。

* 插值过程中，误差=截断误差+舍入误差

  舍入误差在插值计算过程中可能被放大：插值稳定性问题-》高次多项式稳定性差

* 分段线性插值

  * 每个小区间[$x_i,x_{i+1}$]作以两端点为节点的线性插值，再把所有函数连接起来

    ![image-20210227220617022](D:\科大\大三上\计算方法\image\image-20210227220617022.png)

  * 只要f(x)连续，则分段线性插值序列可以收敛于f(x)

    ![image-20210227220635025](D:\科大\大三上\计算方法\image\image-20210227220635025.png)

  * 缺点：插值点处不光滑

##### 1.4.2 三次样条插值的M关系式

* 三次样条插值函数、样条节点：定义1.4![image-20210227221111524](D:\科大\大三上\计算方法\image\image-20210227221111524.png)

* ![image-20210227221517714](D:\科大\大三上\计算方法\image\image-20210227221517714.png)

* ![image-20210227221736777](D:\科大\大三上\计算方法\image\image-20210227221736777.png)

* 大M关系式构造

  * 用2次条件![image-20210227222106547](D:\科大\大三上\计算方法\image\image-20210227222106547.png)

  * 对$S''_i(x)$作两次积分![image-20210227223357611](D:\科大\大三上\计算方法\image\image-20210227223357611.png)

  * 用0次条件![image-20210227222236589](D:\科大\大三上\计算方法\image\image-20210227222236589.png)

    ![image-20210227222357713](D:\科大\大三上\计算方法\image\image-20210227222357713.png)

  * 用1次条件![image-20210227222414082](D:\科大\大三上\计算方法\image\image-20210227222414082.png)

  * 得到的关系式再加上额外两个边界条件，可解出方程组1.23， 从而得到1.22
    ![image-20210227222731357](D:\科大\大三上\计算方法\image\image-20210227222731357.png)

  * 两个边界条件的讨论

    1. ![image-20210227223100884](D:\科大\大三上\计算方法\image\image-20210227223100884.png)
    2. ![image-20210227223111862](D:\科大\大三上\计算方法\image\image-20210227223111862.png)
    3. ![image-20210227223123291](D:\科大\大三上\计算方法\image\image-20210227223123291.png)

##### 1.4.3 三次样条插值的m关系式

* ![image-20210227223657034](D:\科大\大三上\计算方法\image\image-20210227223657034.png)

### 第二章 最小二乘拟合

##### 2.1 拟合函数

* ![image-20210227232839470](D:\科大\大三上\计算方法\image\image-20210227232839470.png)

  误差计算：L1,L2,L$\infty$范数

  ![image-20210227232920087](D:\科大\大三上\计算方法\image\image-20210227232920087.png)

* 误差平方和最小的原则：最小二乘法

* 构造拟合函数的关键：选择适当的拟合函数类型![image-20210227233225701](D:\科大\大三上\计算方法\image\image-20210227233225701.png)

  拟合操作

  * 表示误差Q
  * 求导=0处为最小值
  * 整理得关于参数的线性方程组(或矩阵表示)，求解即可

##### 2.2 多项式拟合

* n次多项式拟合![image-20210227233449207](D:\科大\大三上\计算方法\image\image-20210227233449207.png)![image-20210227233506469](D:\科大\大三上\计算方法\image\image-20210227233506469.png)

  取最小值

  * 对线性拟合（n=1)时![image-20210227233815779](D:\科大\大三上\计算方法\image\image-20210227233815779.png)

    ![image-20210227233838335](D:\科大\大三上\计算方法\image\image-20210227233838335.png)

  * 一般的多项式拟合![image-20210227234123832](D:\科大\大三上\计算方法\image\image-20210227234123832.png)

    ![image-20210227234143931](D:\科大\大三上\计算方法\image\image-20210227234143931.png)

* 三角函数拟合

* 事实上，只要对于$\phi(x)$是关于$a_0,...,a_n$的线性函数即可

  ![image-20210227234600790](D:\科大\大三上\计算方法\image\image-20210227234600790.png)

* 进阶：不是关于线性组合，考虑人为作函数变换提高求解效率（但可能降低求解精度）

  * 指数函数：取对数,例2.5
  * 双曲函数：取倒数
  * 有理函数：分母提出来
  * ![image-20210227235358136](D:\科大\大三上\计算方法\image\image-20210227235358136.png)

##### 2.3 矛盾方程组

* 拟合函数![image-20210228000841891](D:\科大\大三上\计算方法\image\image-20210228000841891.png)

  ![image-20210228000857949](D:\科大\大三上\计算方法\image\image-20210228000857949.png)

  $Q(\alpha)=||A\alpha-Y||_2^2$

* 定理2.1四个结论，实际上矛盾方程组的最小二乘解个数与法方程$A^TA\alpha=A^TY$解个数一致

  ![image-20210228001057529](D:\科大\大三上\计算方法\image\image-20210228001057529.png)

  ![image-20210228001814047](D:\科大\大三上\计算方法\image\image-20210228001814047.png)

  ![image-20210228002008218](D:\科大\大三上\计算方法\image\image-20210228002008218.png)

* 只需求解矛盾方程组$A\alpha=Y$的法方程$A^TA\alpha=A^TY$即可

  这也叫做用求矛盾方程组的最小二乘法拟合$\phi(x)$



### 第三章 非线性方程求解

* 思想：构造序列并用迭代解来近似准确解
* 非线性方程的根可能不止一个，在求解时需给定初始值或求解范围

##### 收敛阶

* 分析方法：Taylor

#### 3.1 迭代法

##### 3.1.1 实根的对分法

* 即对分法(二分法)：利用介值定理![image-20210228095532746](D:\科大\大三上\计算方法\image\image-20210228095532746.png)
* 注意算法的停止条件![image-20210228095735982](D:\科大\大三上\计算方法\image\image-20210228095735982.png)
* 二分法的优劣![image-20210228095835300](D:\科大\大三上\计算方法\image\image-20210228095835300.png)

##### 3.1.2 不动点迭代：$x=\psi(x)$

* ![image-20210228100048411](D:\科大\大三上\计算方法\image\image-20210228100048411.png)

* 问题：对f(x)=0构造的多种迭代格式，怎样判断该迭代格式是否收敛？收敛速度与哪个量有关？收敛是否与迭代的初值有关？

* 不动点的存在、唯一性条件![image-20210228100240923](D:\科大\大三上\计算方法\image\image-20210228100240923.png)

  1. 唯一性证明![image-20210228101051766](D:\科大\大三上\计算方法\image\image-20210228101051766.png)

  2. 收敛性证明![image-20210228101842133](D:\科大\大三上\计算方法\image\image-20210228101842133.png)

  3. 误差估计证明：（误差估计的计算，利用了中值定理以及一阶导数的界）

     ![image-20210228101113913](D:\科大\大三上\计算方法\image\image-20210228101113913.png)

  

  * 拉格朗日中值定理![image-20210228100454400](D:\科大\大三上\计算方法\image\image-20210228100454400.png)

* 书p62下面的笔记：计算实例

  注意到，如果题目初始所给区间找不到很好的$\psi(x)$,那么可以考虑对区间收缩如[1,2]  -> [1,1.5]

* 迭代的收敛速度
  * 若$\psi(x)$导数的界L越小，那么迭代的收敛速度越快
  * ![image-20210228102202242](D:\科大\大三上\计算方法\image\image-20210228102202242.png)

#### 3.2 Newton迭代法

* 对f(x)Taylor展开取其线性部分（一次函数）构造 -》 局部线性化

  ![image-20210228103348303](D:\科大\大三上\计算方法\image\image-20210228103348303.png)

* ![image-20210228103423466](D:\科大\大三上\计算方法\image\image-20210228103423466.png)

* newton迭代法的收敛情况

  * 单根与收敛阶

    ![image-20210228104235227](D:\科大\大三上\计算方法\image\image-20210228104235227.png)

  * p重根与收敛阶（第二张图里的第二个$\psi(x)$）表达式有点问题）![image-20210228105056306](D:\科大\大三上\计算方法\image\image-20210228105056306.png)

    ![image-20210228105119883](D:\科大\大三上\计算方法\image\image-20210228105119883.png)

    变式后的二阶方法：$\psi'(\alpha)$=0

* Newton迭代法局限性：收敛与否依赖于初值选取，越靠近精确解越好

  如果f(x)=0无实根，则迭代序列不收敛

* 几何意义：在迭代点$x_k$作切线，与x轴交点作为下一次迭代点

#### 3.3 弦截法(割线法)

* 迭代格式及收敛阶

  ![image-20210228110714491](D:\科大\大三上\计算方法\image\image-20210228110714491.png)

* 几何意义：![image-20210228111000254](D:\科大\大三上\计算方法\image\image-20210228111000254.png)

#### 3.4 求解非线性方程组的Newton方法

* 以二阶方程组为例：对两个非线性方成作二元Tylor展开，然后求解得到新迭代点
  1. ![image-20210228111552065](D:\科大\大三上\计算方法\image\image-20210228111552065.png)
  2. ![image-20210228111613003](D:\科大\大三上\计算方法\image\image-20210228111613003.png)
  3. 矩阵表示![image-20210228111833354](D:\科大\大三上\计算方法\image\image-20210228111833354.png)
  4. 得到新的点后再继续迭代
* Newton迭代法求二阶非线性方程组的几何意义：作出两个非线性方程在(x0,y0)处的切平面 -> 切平面=0为零曲线 -> 两条零曲线交点为(x1,y1)
* 由二阶推广到n个变量![image-20210228113939246](D:\科大\大三上\计算方法\image\image-20210228113939246.png)

![image-20210304113835549](D:\科大\大三上\计算方法\image\image-20210304113835549.png)

### 第四章 求解线性方程组的直接法

#### 概述

* 线性方程组的一般形式、矩阵形式，及其存在唯一解的条件

  ![image-20210228114642863](D:\科大\大三上\计算方法\image\image-20210228114642863.png)

* Crammer法则给出线性方程组的公式解，但计算量太大

  ![image-20210228114746382](D:\科大\大三上\计算方法\image\image-20210228114746382.png)

* 线性方程组解法：
  * 直接解法
    * 无系统误差，对系数矩阵和常数向量无特殊要求
    * 可得到公式解
    * 存在舍入误差（特别是A，b含浮点数时）
  * 迭代解法
    * 随着迭代次数的增加，减少系统误差。
    * 使用时，通常限制迭代次数，得到满足一定精度的近似解

#### 4.1 Gauss消元法

* 特殊矩阵形式：对角阵（O(n)）、下三角阵($O(n^2)$)、上三角阵($O(n^2)$)
* 消元法思想：对方程组作初等变换化为上述形式

##### 4.1.1 Gauss顺序消元法

* Gauss消元法:即作初等变换=>上三角阵

  即打洞法，由第一行把其余行的第一列系数全变为0，依次类推

* Guass-Jordan消元法：初等变换->上三角阵 -》 对角阵 ->再求解

##### 4.1.2 Gauss列主元消元法

* 主子式、顺序主子式：https://zhidao.baidu.com/question/579637661.html

* 顺序消元法可行的充要条件：A的各阶顺序主子式不为0，但是：![image-20210228120234178](D:\科大\大三上\计算方法\image\image-20210228120234178.png)

* 定理4.1![image-20210228121127215](D:\科大\大三上\计算方法\image\image-20210228121127215.png)

* 列主元法引入的原因：如果$a_{11}$值过小，那么在顺序消元法过程里，$a_{11}$作分母会带来很大误差 -》 考虑交换方程次序，把较大的值放到$a_{11}$的位置

* 方法：调换方程组次序，使得作分母的量的绝对值尽量大，以减少舍入误差

  每次选第i列(i=1,2,...,n)**绝对值最大**的元素，交换方程所有元素即可
  
  ![image-20210228121622203](D:\科大\大三上\计算方法\image\image-20210228121622203.png)
  
* 例子：p83 例4.3：从增广矩阵入手

* 变式：全主元法

* 矩阵中每个主对角元素的模都大于与它同行的其他元素的模的总和.这种矩阵就叫‘严格对角占优的’

  ![image-20210228142205796](D:\科大\大三上\计算方法\image\image-20210228142205796.png)

#### 4.2 直接分解法

Gauss消元法有重复计算的问题

* 考虑A=LU的矩阵分解![image-20210228142725132](D:\科大\大三上\计算方法\image\image-20210228142725132.png)

  ![image-20210228142745374](D:\科大\大三上\计算方法\image\image-20210228142745374.png)

* 矩阵分解后的计算方式

  ![image-20210228143453285](D:\科大\大三上\计算方法\image\image-20210228143453285.png)

##### 4.2.1 Doolittle分解

* L为单位下三角阵（下三角阵的对角元素为1）
* 分解的步骤即待定系数法，从$u_{11}$开始，然后U第1行、L第一列； U第2行、L第2列....依次算，最后得到整个矩阵
* ![image-20210228143254562](D:\科大\大三上\计算方法\image\image-20210228143254562.png)

##### 4.2.2 Crout分解

* U为单位上三角阵![image-20210228143716214](D:\科大\大三上\计算方法\image\image-20210228143716214.png)
* 从$l_{11}$开始，然后L第1列、U第1行； L第2列、U第2行....依次算

##### 4.2.3 特殊线性方程组

* 三对角方程组![image-20210228144200373](D:\科大\大三上\计算方法\image\image-20210228144200373.png)

  ![image-20210228144214992](D:\科大\大三上\计算方法\image\image-20210228144214992.png)

  ![image-20210228144232457](D:\科大\大三上\计算方法\image\image-20210228144232457.png)

  上述求解方式称为追赶法或Thomas算法

  1. 追：在n重for循环里依次计算$u_k,v_k,y_k$
  2. 赶：从n到1依次计算$x_k$

* **对称正定矩阵**的$LDL^T$分解

  * 以Doolittle分解为基础：最后得到的L矩阵与Doolittle分解里的一样，对角阵D就是 U矩阵的对角元素

    ![image-20210228144935653](D:\科大\大三上\计算方法\image\image-20210228144935653.png)

  * 以Crout分解为基础：分解为上三角阵![image-20210228145314472](D:\科大\大三上\计算方法\image\image-20210228145314472.png)

  * 当然也可考虑自己直接计算$LDL^T$

  * 求出分解后，如何解方程组：![image-20210228145932518](D:\科大\大三上\计算方法\image\image-20210228145932518.png)

* 补充：$LDM^T$分解

  * L,M为单位下三角阵，D为对角阵

  * 实对称矩阵：$A=LDL^T$

  * 正定实对称阵: $A=L\sqrt{D}\sqrt{D}L^T=pp^T ,  \sqrt{D}=diag(\sqrt{d_{ii}})$,    P为下三角阵

    cholesky分解 

  * ![image-20210228150350725](D:\科大\大三上\计算方法\image\image-20210228150350725.png)

### 第五章 求解线性方程组的迭代方法

主要参考笔记

#### 概述

* 迭代法的思想：迭代矩阵、收敛条件。类比第三章非线性方程求根

  ![image-20210228154144904](D:\科大\大三上\计算方法\image\image-20210228154144904.png)

  ![image-20210228154833969](D:\科大\大三上\计算方法\image\image-20210228154833969.png)

* 收敛条件：谱半径是充要条件；任意范数是充分条件；然后每一种迭代格式对应有其行、列对角占优矩阵的条件![image-20210228155158806](D:\科大\大三上\计算方法\image\image-20210228155158806.png)

  具体：![image-20210228155353941](D:\科大\大三上\计算方法\image\image-20210228155353941.png)

* 本章后续主要是根据选取不同的N，从而得到不同的收敛条件、收敛速度

* 本章各种例题解法主要是：选定迭代方法，列出对应题目的迭代格式，然后选定初值以及误差界，最后列表一轮一轮迭代，直到满足误差解条件。

* 矩阵范数、谱半径

  矩阵特征值求法：https://blog.csdn.net/Junerror/article/details/80222540

#### 补充 理查森方法

* ![image-20210228160053620](D:\科大\大三上\计算方法\image\image-20210228160053620.png)

#### 5.1 简单(Jacobi)迭代

* ![image-20210228160402498](D:\科大\大三上\计算方法\image\image-20210228160402498.png)

* 迭代格式的来由

  ![image-20210228160710666](D:\科大\大三上\计算方法\image\image-20210228160710666.png)

#### 5.2 Gauss-Seidel迭代

* 迭代形式![image-20210228161446787](D:\科大\大三上\计算方法\image\image-20210228161446787.png)

  格式即![image-20210228162111457](D:\科大\大三上\计算方法\image\image-20210228162111457.png)

* 收敛条件![image-20210228161506766](D:\科大\大三上\计算方法\image\image-20210228161506766.png)

* 特别的：迭代矩阵的2种计算方式，实体书p104打星号

#### 5.3 松弛迭代（SoR）

* 松弛迭代（SoR）：多了一个松弛因子

  ![image-20210228163658617](D:\科大\大三上\计算方法\image\image-20210228163658617.png)

* 迭代具体形式，只是在Gauss-Seidel的基础上加了一点点

  ![image-20210228164103591](D:\科大\大三上\计算方法\image\image-20210228164103591.png)

#### 例题：参见第五章笔记最后（ipad书138-139）

#### 对称超松弛（SSoR）

* ？？

### 第六章 数值积分和数值微分

##### 代数精度

##### 截断误差阶

#### 概述

* 待定系数法求数值积分：第六章开头那一页笔记，从0阶开始列式子； 代数精度

#### 6.1 牛顿-柯特斯数值积分

* 定积分：牛顿-莱布尼兹公式不适用的情况下，考虑数值积分公式计算定积分

* 原理：定积分是黎曼和的极限

* $I(f) \approx I_n(f)$

  ![image-20210228170330567](D:\科大\大三上\计算方法\image\image-20210228170330567.png)

* 判断数值积分公式效果：

  代数精度：取$f(x)=x^k$

  ![image-20210228170613901](D:\科大\大三上\计算方法\image\image-20210228170613901.png)

  ![image-20210228170622867](D:\科大\大三上\计算方法\image\image-20210228170622867.png)

* 当$I_n(f)$具有m阶代数精度时，对任意<=m次多项式f(x)都有$I(f)=I_n(f)$

##### 6.1.1 插值型数值积分

* 对点列，用Langrange插值多项式$L_n(x)$来近似
* 若f(x)<=n次多项式，则$L_n(x)=f(x)$,有$E_n(f)=0$
* n阶插值多项式形式的数值积分公式至少有n阶代数精度, 但最多不超过2n+1阶代数精度
* ![image-20210228171520932](D:\科大\大三上\计算方法\image\image-20210228171520932.png)

##### 6.1.2 牛顿-柯特斯积分（Newton-Cotes）

* 也是Langrange插值多项式，不过对数值积分的求积节点有要求：n等分点

  ![image-20210228172200902](D:\科大\大三上\计算方法\image\image-20210228172200902.png)

* 梯形积分：用x=a,x=b两点构造

  $T(f)=\frac{b-a}2 [f(a)+f(b)]$

  * ![image-20210228172542215](D:\科大\大三上\计算方法\image\image-20210228172542215.png)
  * 几何意义：梯形面积代替积分值
  * 1阶代数精度
  * ![image-20210228172901017](D:\科大\大三上\计算方法\image\image-20210228172901017.png)

* 辛普森积分(Simpson)

  * 取a,(a+b)/2,b三点
  * 得S(f)=$\frac{b-a}6 [f(a)+4f(\frac{a+b}2)+f(b)]$
  * 称为辛普森或抛物线积分公式
  * 3阶代数精度
  * ![image-20210228173823116](D:\科大\大三上\计算方法\image\image-20210228173823116.png)

* Newton-Cotes积分误差及代数精度结论(书p115)

  ![image-20210228174052058](D:\科大\大三上\计算方法\image\image-20210228174052058.png)

* Newton-Cotes积分系数

  ![image-20210228174310566](D:\科大\大三上\计算方法\image\image-20210228174310566.png)

* n<=7 时Newton-Cotes数值积分公式是稳定的

#### 6.2 复化数值积分

* 插值的Runge现象可知，高阶Newton-Cotes积分不能保证等距数值积分系数的收敛性，其计算也是不稳定的。

##### 6.2.1 复化梯形积分

* 每个小区间用梯形积分公式，再累加

* 计算公式：记作T(h)或$T_n(f)$(书p118式6.6)

  ![image-20210228175001653](D:\科大\大三上\计算方法\image\image-20210228175001653.png)

* 截断误差：![image-20210228175108570](D:\科大\大三上\计算方法\image\image-20210228175108570.png)

  ![image-20210228175125237](D:\科大\大三上\计算方法\image\image-20210228175125237.png)

* 只要f(x)在(a,b)上有界并且黎曼可积，当分点n->$\infty$，复化梯形公式收敛到积分I(f)

* 任给误差控制小量，均存在满足条件的n值![image-20210228175247280](D:\科大\大三上\计算方法\image\image-20210228175247280.png)

##### 6.2.2 复化Simpson积分

* 区间偶数2m等分，记n=2m，n+1是节点总数，m是积分子区间总数，h=$\frac{b-a}n$

  ![image-20210228175711499](D:\科大\大三上\计算方法\image\image-20210228175711499.png)

* 复化Simpson公式的截断误差：式6.9(p120)

  ![image-20210228175957600](D:\科大\大三上\计算方法\image\image-20210228175957600.png)

* 只要f(x)在(a,b)上有界并且黎曼可积，当分点n->$\infty$，复化Simpson公式收敛到积分I(f)

* 任给误差控制小量，均存在满足条件的n值

  ![image-20210228180128288](D:\科大\大三上\计算方法\image\image-20210228180128288.png)

##### 6.2.3 自动控制误差的复化积分

##### 6.2.4 龙贝格积分



#### 6.4 高斯型积分

* ![image-20210228181929478](D:\科大\大三上\计算方法\image\image-20210228181929478.png)
* ![image-20210228182027344](D:\科大\大三上\计算方法\image\image-20210228182027344.png)

##### 6.4.1 勒让德多项式

![image-20210228200431035](D:\科大\大三上\计算方法\image\image-20210228200431035.png)

##### 6.4.2 Gauss-Legendre积分

* ![image-20210228201103716](D:\科大\大三上\计算方法\image\image-20210228201103716.png)
* ![image-20210228201308123](D:\科大\大三上\计算方法\image\image-20210228201308123.png)
* ![image-20210228201524492](D:\科大\大三上\计算方法\image\image-20210228201524492.png)

#### 6.5 数值微分

##### 6.5.1 差商与数值微分

* 数值微分近似$f'(x)$
* 最简单的方法：用差商近似函数的导数
  * 向前差商![image-20210228202634244](D:\科大\大三上\计算方法\image\image-20210228202634244.png)
  * 向后差商![image-20210228202738216](D:\科大\大三上\计算方法\image\image-20210228202738216.png)
  * 中心差商![image-20210228202953946](D:\科大\大三上\计算方法\image\image-20210228202953946.png)
* 差商的几何意义
* 事后估计方法选取步长![image-20210228203754965](D:\科大\大三上\计算方法\image\image-20210228203754965.png)

##### 6.5.2 插值型数值微分

* ![image-20210228204027918](D:\科大\大三上\计算方法\image\image-20210228204027918.png)

* 待定系数法与精度





### 第七章 常微分  方程数值解

##### p阶精度格式

* 主要讨论初值问题
* 有限差分方法![image-20210228210119760](D:\科大\大三上\计算方法\image\image-20210228210119760.png)

#### 7.1 Euler公式

##### 7.1.1 基于数值微商的Euler公式

* 向前差商近似（显式格式：由$y_n$直接算出$y_{n+1}$）![image-20210228211952429](D:\科大\大三上\计算方法\image\image-20210228211952429.png)
* 向后差商近似![image-20210228212859864](D:\科大\大三上\计算方法\image\image-20210228212859864.png)
  1. 一般的迭代格式：![image-20210228213201778](D:\科大\大三上\计算方法\image\image-20210228213201778.png)
  2. 预估-校正格式：![image-20210228213249265](D:\科大\大三上\计算方法\image\image-20210228213249265.png)
* 中心差商近似![image-20210228213429981](D:\科大\大三上\计算方法\image\image-20210228213429981.png)

##### 7.1.2 Euler公式的收敛性与精度

* 局部截断误差![image-20210228213755319](D:\科大\大三上\计算方法\image\image-20210228213755319.png)
* ==整体截断误差和收敛性？==

##### 7.1.3 基于数值积分的近似公式

* 对微分方程积分后，近似估计积分![image-20210228215327661](D:\科大\大三上\计算方法\image\image-20210228215327661.png)
* ![image-20210228215507913](D:\科大\大三上\计算方法\image\image-20210228215507913.png)

#### 7.2 Runge-Kutta方法

* one-step, multi-stage
* Taylor方法：直接对y(x+h)展开，参见书p146后面一页笔记
* 本质是Taylor展开后线性逼近：S阶RK方程格式，有待定系数，无穷多组解

##### 7.2.1 二阶Runge-Kutta方法

* 从Taylor展开入手，得到任意阶精度格式的公式

  1. ![image-20210228221428554](D:\科大\大三上\计算方法\image\image-20210228221428554.png)
  2. ![image-20210228221630345](D:\科大\大三上\计算方法\image\image-20210228221630345.png)
  3. ![image-20210228221705558](D:\科大\大三上\计算方法\image\image-20210228221705558.png)

* 于是Runge-Kutta方法里考虑用线性组合来逼近上述有偏导计算的式子![image-20210228221926284](D:\科大\大三上\计算方法\image\image-20210228221926284.png)

* ![image-20210228222552209](D:\科大\大三上\计算方法\image\image-20210228222552209.png)

  有无数多组解

* 一般形式的二阶Runge-Kutta方法![image-20210228222624232](D:\科大\大三上\计算方法\image\image-20210228222624232.png)

  ![image-20210228222901803](D:\科大\大三上\计算方法\image\image-20210228222901803.png)

##### 7.2.2 四阶Runge-Kutta方法

* S阶一般形式（第三个式子有问题， $y_1 ...y_s 全改为k_1...k_s$）![image-20210228223134743](D:\科大\大三上\计算方法\image\image-20210228223134743.png)
* 三  阶![image-20210228223959377](D:\科大\大三上\计算方法\image\image-20210228223959377.png)

#### 7.3 线性多步法

* multi-step
* 一般用精确解$y(x_{n})和近似解y_n$分别在$x_n$处Taylor展开来估计局部截断误差
* 用数值积分近似求解常微分方程初值问题的方法：关键是p，q值
  * ![image-20210228233738083](D:\科大\大三上\计算方法\image\image-20210228233738083.png)
  * 显示多步、隐式多步：数值积分近似积分时取的点略有不同
  * **例7.4：三步(积分节点个数)三阶(误差$T_{n+1}$)**![image-20210228234215796](D:\科大\大三上\计算方法\image\image-20210228234215796.png)
  * 起步计算：y1,y2的计算，可以用Runge-Kutta等公式来做，但要注意精度问题：起步计算精度至多比线性多步法的精度低一阶
  * 例7.5：隐式格式
    * 可考虑用显示格式作为初值估计，得到预估-校正公式![image-20210228234720149](D:\科大\大三上\计算方法\image\image-20210228234720149.png)
    * p=0的格式：Adams公式，分为显示和隐式

#### 7.4 常微分方程组的数值解法

##### 7.4.1 一阶常微分方程的数值解法

* 一阶ODE方程组初值问题：写成向量形式，仍可用前面所讲Euler方法，Runge-Kutta方法等，公式都不变你，只是标量换成向量

* ![image-20210301093517406](D:\科大\大三上\计算方法\image\image-20210301093517406.png)

  ![image-20210301093548441](D:\科大\大三上\计算方法\image\image-20210301093548441.png)

* 具体方法对应的公式：![image-20210301093636250](D:\科大\大三上\计算方法\image\image-20210301093636250.png)

  ![image-20210301093842663](D:\科大\大三上\计算方法\image\image-20210301093842663.png)

* 二阶ODE：书p155笔记

##### 7.4.2 高阶常微分方程数值解法

* 本质即化为一阶方程组![image-20210301094238285](D:\科大\大三上\计算方法\image\image-20210301094238285.png)

### 第八章 计算矩阵的特征值和特征向量

#### 概述

* ![image-20210301094913146](D:\科大\大三上\计算方法\image\image-20210301094913146.png)

#### 8.1 幂法

##### 8.1.1 幂法计算

* 矩阵的谱半径：矩阵的按模最大特征值的值

* **幂法：计算矩阵的按模最大特征值及对应的特征向量**

  ![image-20210301095939286](D:\科大\大三上\计算方法\image\image-20210301095939286.png)

  1. 按模最大特征值只有一个，且为单实根

     * ![image-20210301100157708](D:\科大\大三上\计算方法\image\image-20210301100157708.png)
     * 收敛速度取决于比值大小(p166)![image-20210301100309482](D:\科大\大三上\计算方法\image\image-20210301100309482.png)

  2. 按模最大特征值是互为反号的实根

     * ![image-20210301101118870](D:\科大\大三上\计算方法\image\image-20210301101118870.png)

     * 特征值、特征向量：式8.7，8.8![image-20210301101139779](D:\科大\大三上\计算方法\image\image-20210301101139779.png)
     
     判断两类的方法：书p167 8.1.2节前面一段

* ![image-20210301101305835](D:\科大\大三上\计算方法\image\image-20210301101305835.png)

##### 8.1.2 幂法的规范运算

* 存在上溢、下溢问题
* 公式![image-20210301102041079](D:\科大\大三上\计算方法\image\image-20210301102041079.png)
* 三类收敛情况讨论：p168
  1. ![image-20210301102351969](D:\科大\大三上\计算方法\image\image-20210301102351969.png)
  2. ![image-20210301102525938](D:\科大\大三上\计算方法\image\image-20210301102525938.png)
  3. ![image-20210301102742701](D:\科大\大三上\计算方法\image\image-20210301102742701.png)

* 原点位移法：加速收敛 （书p170），下面A特征值为$\lambda, B为\lambda-p$![image-20210301103338725](D:\科大\大三上\计算方法\image\image-20210301103338725.png)

#### 8.2 反幂法

* 求按模最小的特征值及其特征向量![image-20210301103921452](D:\科大\大三上\计算方法\image\image-20210301103921452.png)
* 利用A矩阵的逆来转换为幂法求解
  * 规范迭代：书p171
  * 一般不求逆，而是解线性方程组：参见第四章LU分解
* 变式:求最接近p的特征值：![image-20210301104134552](D:\科大\大三上\计算方法\image\image-20210301104134552.png)
  * 位移幂法
  * 位移反幂法![image-20210301104226040](D:\科大\大三上\计算方法\image\image-20210301104226040.png)

#### 8.3 实对称矩阵的jacobi方法

* 已知事实：![image-20210301110456264](D:\科大\大三上\计算方法\image\image-20210301110456264.png)
* ![image-20210301110431909](D:\科大\大三上\计算方法\image\image-20210301110431909.png)

* 二阶对称矩阵：![image-20210301111300094](D:\科大\大三上\计算方法\image\image-20210301111300094.png)

  ![image-20210301111312859](D:\科大\大三上\计算方法\image\image-20210301111312859.png)

* 高于二阶的对称矩阵![image-20210301111353092](D:\科大\大三上\计算方法\image\image-20210301111353092.png)
* $B=Q^TAQ$![image-20210301111839070](D:\科大\大三上\计算方法\image\image-20210301111839070.png)
* 注意：![image-20210301112732559](D:\科大\大三上\计算方法\image\image-20210301112732559.png)